# BACnet

作者：Askr  
时间：2023/12/17

## 基础知识：  
+ BACnet是一种BMS用于楼宇中设备实现控制所需要的协议，一般BMS系统都有一个专门的本地或云服务器进行管理。
+ Milesight设备是否支持BACnet这个问题，要分为两个部分进行回答
    + 网关设备中有UG65/67/56支持，支持的是将组网内的节点数据走BACnetIP的方式传输到BACnet Server中，一般物理连接是通过RJ45网口直连，或通过路由器交换机处于同一个网络内连接，并且可以在网关后台配置节点参数的对象（object）和对应的类型（整型，浮点型等）
    + 节点设备由于本身不直接支持BACnet，是否支持其实取决于网关是否支持。一般传感器的用法是将数据上行到网关，并通过内置NS转换为BACnet协议后，传输到BACnet服务器中
    + 控制器（例如UC100/300/500）开启双向透传（Passthrough）后，可以直接从BACnet Server双向通信。



## 问答
#### Q:我们的网关是否有bacnet介入对象数量限制  
A：数千个接入对象是没问题的，具体数据需要找一下  
解析：对于一个终端节点设备，其数据通过BACnet协议传输到BMS时，要将其数据映射到对象中。例如AM319有9个不同的参数，加上设备开关机，至少需要10个对象走BACnet上到BMS。该数量的硬件限制主要在网关的运行内存上。    
补充：有些竞品网关会在固件层面对BACnet接入对象作数量限制，保障运行内存充分的同时，对高于限制数量的部分收费。  


#### Q.BMS通过BACnet接入UG网关，后通过LoRa连接到UC100，再走RS485连接到传统设备，在这样的拓扑里，需要做什么额外工作？  
A：技术侧再codec中新增一块预定义代码，实现bacnet和modbus的映射转换，无需研发介入，不用作硬件上其他任何修改，设备需开启双向透传  
解析：Modbus协议的本质就是再多个寄存器通道中传输数据，当数据通过LoRa到Bacnet中的时候，寄存器中的数据将会被映射到BACnet的对象中，此步骤需要通过coder进行转换  
